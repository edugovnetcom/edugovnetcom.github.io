<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Computing With Permutations, Inverses, Cycles, and More! - EduGovNet.com</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Computing With Permutations, Inverses, Cycles, and More!" />
<meta property="og:description" content="In this entry, we bring together ideas we&rsquo;ve been developing about permutations, their sign, cycles, and sorting as well as the run time complexity of the algorithms which compute them." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/computing-with-permutations-inverses-cycles-and-more/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2021-07-19T14:26:15-04:00" />
<meta property="article:modified_time" content="2021-07-19T14:26:15-04:00" />


		<meta itemprop="name" content="Computing With Permutations, Inverses, Cycles, and More!">
<meta itemprop="description" content="In this entry, we bring together ideas we&rsquo;ve been developing about permutations, their sign, cycles, and sorting as well as the run time complexity of the algorithms which compute them."><meta itemprop="datePublished" content="2021-07-19T14:26:15-04:00" />
<meta itemprop="dateModified" content="2021-07-19T14:26:15-04:00" />
<meta itemprop="wordCount" content="1233">
<meta itemprop="keywords" content="Permutations," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Computing With Permutations, Inverses, Cycles, and More!"/>
<meta name="twitter:description" content="In this entry, we bring together ideas we&rsquo;ve been developing about permutations, their sign, cycles, and sorting as well as the run time complexity of the algorithms which compute them."/>

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="shortcut icon" href="/images/favicon.png">
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed">
		<a class="logo__link" href="/" title="EduGovNet.com" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/images/aleph_heiroglyph.png">
				</div><div class="logo__item logo__text">
					<div class="logo__title">EduGovNet.com</div>
					<div class="logo__tagline">Let&#39;s strive to have our mistakes be honest mistakes.</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				<i class='fa fa-heart'></i>
				<span class="menu__text">Home</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/contact_us/">
				
				<span class="menu__text">Contact Us</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Computing With Permutations, Inverses, Cycles, and More!</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">Mike</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2021-07-19T14:26:15-04:00">2021-07-19</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/algorithms/" rel="category">Algorithms</a>
	</span>
</div></div>
		</header>
		<figure class="post__thumbnail">
			<img src="/images/biking_in_flood.jpg" alt="Computing With Permutations, Inverses, Cycles, and More!">
		</figure>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#disjoint_cycles">disjoint_cycles()</a></li>
    <li><a href="#permutation_inverse">permutation_inverse()</a></li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p><span class="first-letter">I</span>n this entry, we bring together ideas we&rsquo;ve been developing about permutations, their sign, cycles, as well as the run time complexity of the algorithms which compute them. We begin by providing a C++ implementation of a function which will break down a permutation into disjoint cycles. Its runtime complexity is in \(O(n)\), for a permutation on \(\{0, 1, 2, &hellip;, n-1 \}\).</p>
<p>We begin by implementing a ceiling function, <code>int32_t ceil(int32_t num, int32_t denom)</code>, which will return \(\left\lceil \frac{ \text{num} }{ \text{denom} }\right\rceil\).</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#2b91af">int32_t</span> ceil(<span style="color:#2b91af">int32_t</span> num, <span style="color:#2b91af">int32_t</span> denom)
{
  <span style="color:#00f">if</span> (denom == 0) <span style="color:#00f">return</span> INT32_MIN;
  <span style="color:#00f">return</span> (num % denom ? 1 : 0) + (num / denom);
}</code></pre></td></tr></table>
</div>
</div>
<p>Next we provide two functions. The first checks whether the \(i^{th}\) bit of an array of uint64_ts is equal to 1. The second function sets the \(i^{th}\) bit of that array to 1.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#2b91af">int16_t</span> check_visited(<span style="color:#2b91af">uint64_t</span>* visited, <span style="color:#2b91af">int64_t</span> i)
{
  <span style="color:#00f">if</span> (!visited) <span style="color:#00f">return</span> 0;
  <span style="color:#2b91af">int16_t</span> r = i % <span style="color:#00f">sizeof</span>(<span style="color:#2b91af">uint64_t</span>);
  <span style="color:#2b91af">int64_t</span> q = i / <span style="color:#00f">sizeof</span>(<span style="color:#2b91af">uint64_t</span>);

  <span style="color:#00f">return</span> (visited[q] &amp; (1 &lt;&lt; r)) ? 1 : 0;
}

<span style="color:#2b91af">void</span> set_visited(<span style="color:#2b91af">uint64_t</span>* visited, <span style="color:#2b91af">int64_t</span> i)
{
  <span style="color:#00f">if</span> (!visited) <span style="color:#00f">return</span>;
  <span style="color:#008000">// The bit has already been set //
</span><span style="color:#008000"></span>  <span style="color:#00f">if</span> (check_visited(visited, i)) <span style="color:#00f">return</span>;

  <span style="color:#2b91af">int16_t</span> r = i % <span style="color:#00f">sizeof</span>(<span style="color:#2b91af">uint64_t</span>);
  <span style="color:#2b91af">int64_t</span> q = i / <span style="color:#00f">sizeof</span>(<span style="color:#2b91af">uint64_t</span>);

  visited[q] ^= (1 &lt;&lt; r);
}</code></pre></td></tr></table>
</div>
</div>
<p>Now, as promised, we provide the function which breaks the permutation down into disjoint cycles.</p>
<h2 id="disjoint_cycles">disjoint_cycles()</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#2b91af">void</span> disjoint_cycles(<span style="color:#2b91af">int64_t</span>* permutation, <span style="color:#2b91af">int64_t</span> length,
  <span style="color:#2b91af">int64_t</span>** &amp;cycles, <span style="color:#2b91af">int64_t</span>* &amp;lengths, <span style="color:#2b91af">int64_t</span> &amp;num_cycles)
{
  <span style="color:#00f">if</span> (!permutation)
  {
    <span style="color:#00f">return</span>;
  }
  <span style="color:#2b91af">int32_t</span> s = <span style="color:#00f">sizeof</span>(<span style="color:#2b91af">uint64_t</span>); <span style="color:#008000">// this should be 64, but let&#39;s make sure. //
</span><span style="color:#008000"></span>  <span style="color:#2b91af">int32_t</span> c = ceil(length, s);

  num_cycles = 0;
  <span style="color:#2b91af">int64_t</span> i, j, k;

  <span style="color:#2b91af">uint64_t</span> visited[c];

  <span style="color:#00f">for</span>(i = 0; i &lt; c; i++)
  {
    visited[i] = (<span style="color:#2b91af">uint64_t</span>)0;
  }

  <span style="color:#008000">// Loop (a)
</span><span style="color:#008000"></span>  <span style="color:#00f">for</span> (i = 0; i &lt; length; i++)
  {
    <span style="color:#00f">if</span> (check_visited(visited, i)) <span style="color:#00f">continue</span>;
    j = i;
    <span style="color:#00f">while</span> (!check_visited(visited, j))
    {
      set_visited(visited, j);
      j = permutation[j];
    }
    num_cycles++;
  }

  cycles = <span style="color:#00f">new</span> <span style="color:#2b91af">int64_t</span>*[num_cycles];
  lengths = <span style="color:#00f">new</span> <span style="color:#2b91af">int64_t</span>[num_cycles];

  <span style="color:#008000">// now, unset everything //
</span><span style="color:#008000"></span>  <span style="color:#00f">for</span> (i = 0; i &lt; c; i++)
  {
    visited[i] = (<span style="color:#2b91af">uint64_t</span>)0;
  }

  num_cycles = 0;
  <span style="color:#008000">// Loop (b)
</span><span style="color:#008000"></span>  <span style="color:#00f">for</span> (i = 0; i &lt; length; i++)
  {
    <span style="color:#00f">if</span> (check_visited(visited, i))
      <span style="color:#00f">continue</span>;
    j = i;
    (lengths)[num_cycles] = 0;
    <span style="color:#00f">while</span> (!check_visited(visited, j))
    {
      set_visited(visited, j);
      (lengths)[num_cycles]++;
      j = permutation[j];
    }
    (num_cycles)++;
  }

  <span style="color:#00f">for</span> (i = 0; i &lt; c; i++)
  {
    visited[i] = (<span style="color:#2b91af">uint64_t</span>)0;
  }

  <span style="color:#00f">for</span> (i = 0; i &lt; num_cycles; i++)
  {
    cycles[i] = <span style="color:#00f">new</span> <span style="color:#2b91af">int64_t</span>[(lengths)[i]];
  }

  num_cycles = 0;
  <span style="color:#008000">// Loop (c)
</span><span style="color:#008000"></span>  <span style="color:#00f">for</span> (i = 0; i &lt; length; i++)
  {
    <span style="color:#00f">if</span> (check_visited(visited, i))
      <span style="color:#00f">continue</span>;
    j = i;
    k = 0; <span style="color:#008000">// index into this cycle //
</span><span style="color:#008000"></span>    <span style="color:#00f">while</span> (!check_visited(visited, j))
    {
      set_visited(visited, j);
      cycles[num_cycles][k] = j;
      j = permutation[j];
      k++;
    }
    num_cycles++;
  }
}</code></pre></td></tr></table>
</div>
</div>
<p>You&rsquo;ll notice that <code>disjoint_cycles()</code> has three similar for loops. They&rsquo;re labeled loops <code>(a)</code>, <code>(b)</code>, and <code>(c)</code> in the comments.</p>
<p>Loop <code>(a)</code> calculates the number of cycles, which we need to determine how large the <code>cycles</code> and <code>lengths</code> arrays should be before we can allocate them properly.</p>
<p>Loop <code>(b)</code> calculates the length of each cycle. When we have all of those values, we allocate the memory for each loop.</p>
<p>Loop <code>(c)</code> sets the values of each loop.</p>
<p>Each loop executes in \(O(n)\) steps, because the <code>for</code> loop visits an <code>index i</code> with <code>check_visited</code> equal to <code>1</code> at most once. Similarly, the <code>while</code> loop will visit a <code>j</code> with <code>check_visited</code> equal to <code>1</code> at most once. At each iteration of each loop, if <code>check_visited</code> equals <code>0</code>, it is set to <code>1</code> before the next iteration.</p>
<p>Notice that, as we mentioned in <a href="/blog/more-math-of-permutations/">More Math of Permutations</a>, if \(\sigma\) is a <em>k-cycle</em>, then \(\text{Sign}(\sigma) = (-1)^{k-1} \). Therefore we can use the output of <code>disjoint_cycles</code>, to determine \(\text{Sign}(\text{permutation}) \) by calculating \[ \prod\limits_{i = 0}^{\text{num_cycles}-1} (-1)^{\text{lengths}[i] - 1} \tag{1}\label{1}\]</p>
<p>That product will take \(O(\text{num_cycles})\) steps to complete, which will be in \(O(n)\), where \(n\) equals the length of <code>permutation</code>. Since <code>disjoint_cycles</code> also runs in \(O(n)\) steps, the overall cost of computing the \(\text{Sign}(\text{permutation})\) takes \(O(n)\) steps to complete.</p>
<p>This is much better than calculating \(\text{Sign}(\text{permutation})\) using the definition. Recall from <a href="/blog/more-math-of-permutations/">More Math of Permutations</a> that if we let \(\sigma\) denote the permutation, then</p>
<p>\[\text{Sign}(\sigma) = \prod\limits_{i &gt; j} \frac{\sigma(i) - \sigma(j)}{i - j} \tag{2}\label{2}\]</p>
<p>Since that product runs over every pair \( (i,j)\), where \(i &gt; j\), we have to compute \( \frac{n(n-1)}{2}\) products in the numerator and the denominator to evaluate it. This means that the calculation takes \(O(n^2)\) steps to complete. We have achieved a significant speedup!</p>
<p>Next we show how we can use the disjoint cycle breakdown of a permutation to compute its inverse. First we need a few simple observations. Notice that if \( \sigma = \tau_1 \circ \tau_2\), then \(\sigma^{-1} = \tau_2^{-1} \circ \tau_1^{-1} \).</p>
<p>We&rsquo;ve shown that the set of all permutations on a set forms a group under function composition. We&rsquo;ve also shown by the <a href="/blog/more-introductory-group-theory/#mini-lemma-cancellations">cancellations mini-lemma in More Introductory Group Theory</a> that \(\sigma \circ \rho = \sigma \circ \tau\) implies that \(\rho = \tau\).</p>
<p>Now, notice that \(\tau_1 \circ \tau_2 \circ (\tau_2^{-1} \circ \tau_1^{-1})\) equals \(\tau_1 \circ (\tau_2 \circ \tau_2^{-1}) \circ \tau_1^{-1} = \text{id}\). By the cancellations mini-lemma, that means that \( (\tau_1 \circ \tau_2)^{-1} = \tau_2^{-1} \circ \tau_1^{-1}\).</p>
<p>Also notice that if \(\tau_1\) and \(\tau_2\) are disjoint, so that each keeps fixed what the other changes, then we have \( \tau_1 \circ \tau_2 = \tau_2 \circ \tau_1\), because \(\tau_1\)&rsquo;s actions can&rsquo;t affect \(\tau_2\)&rsquo;s actions, and vice versa. This means that if \(\sigma\) is broken into disjoint cycles as \(\tau_1 \circ &hellip; \circ \tau_k\), then \(\sigma^{-1}\) is equal to \(\tau_1^{-1} \circ &hellip; \circ \tau_k^{-1} \).</p>
<p>The inverse of a cycle is extremely easy to calculate. You simply read it &ldquo;backwards&rdquo;. This allows us to easily and quickly compute the inverse of the original permutation.
Here&rsquo;s our implementation in C++</p>
<h2 id="permutation_inverse">permutation_inverse()</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#2b91af">void</span> permutation_inverse(<span style="color:#2b91af">int64_t</span>* permutation, <span style="color:#2b91af">int64_t</span> length, <span style="color:#2b91af">int64_t</span>* &amp;inverse)
{
  <span style="color:#00f">if</span>(!permutation || !inverse) <span style="color:#00f">return</span>;

  <span style="color:#2b91af">int64_t</span>* lengths;
  <span style="color:#2b91af">int64_t</span>** cycles;
  <span style="color:#2b91af">int64_t</span> num_cycles;

  <span style="color:#2b91af">int64_t</span> i, j, l, from, to;

  disjoint_cycles(permutation, length, cycles, lengths, num_cycles);

  <span style="color:#008000">// allocate the output
</span><span style="color:#008000"></span>  inverse = <span style="color:#00f">new</span> <span style="color:#2b91af">int64_t</span>[length];

  <span style="color:#00f">for</span> (i = 0; i &lt; num_cycles; i++)
  {
    l = lengths[i];
    to = cycles[i][l-1]; <span style="color:#008000">// l &gt;= 1, so this is o.k.
</span><span style="color:#008000"></span>    from = cycles[i][0];
    inverse[from] = to;
    <span style="color:#00f">for</span> (j = 1; j &lt; l; j++)
    {
      from = cycles[i][j];
      to = cycles[i][j-1];
      inverse[from] = to;
    }
  }

  <span style="color:#008000">// clean up!
</span><span style="color:#008000"></span>  <span style="color:#00f">delete</span> lengths;
  <span style="color:#00f">for</span> (i = 0; i &lt; num_cycles; i++)
  {
    <span style="color:#00f">delete</span> cycles[i];
  }
  <span style="color:#00f">delete</span> cycles;
}</code></pre></td></tr></table>
</div>
</div>
<p>With this, we&rsquo;ll end the entry. Bye!</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/permutations/" rel="tag">Permutations</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/blog/finding-the-median-and-an-application-to-sorting/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Finding the Median and an Application to Sorting</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/blog/parallel-sorting-in-theory-and-in-practice-i/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Parallel Sorting in Theory and in Practice I</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 EduGovNet.com.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
           extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i = 0; i &lt; all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>
/blog/computing-with-permutations-inverses-cycles-and-more/
<img style="display:none;" src="https://api.edugovnet.com/?page=%2fblog%2fcomputing-with-permutations-inverses-cycles-and-more%2f" />
</body>
</html>